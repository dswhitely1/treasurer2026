# Pre-push hook - runs type checking and tests before push
# Ensures code quality and test coverage are maintained

echo "ğŸ” Running type checking in treasurer-api..."
pnpm --filter treasurer-api type-check || {
  echo ""
  echo "âŒ Type checking failed in treasurer-api. Please fix the issues and try again."
  exit 1
}
echo "âœ… Type checking complete for treasurer-api."

echo ""
echo "ğŸ” Running type checking in treasurer..."
pnpm --filter treasurer type-check || {
  echo ""
  echo "âŒ Type checking failed in treasurer. Please fix the issues and try again."
  exit 1
}
echo "âœ… Type checking complete for treasurer."

echo ""
echo "ğŸ§ª Running tests in treasurer-api..."
pnpm --filter treasurer-api exec vitest run || {
  echo ""
  echo "âŒ Tests failed in treasurer-api. Please fix the failing tests and try again."
  exit 1
}
echo "âœ… All backend tests passed."

echo ""
echo "ğŸ§ª Running tests in treasurer..."
pnpm --filter treasurer exec vitest run || {
  echo ""
  echo "âŒ Tests failed in treasurer. Please fix the failing tests and try again."
  exit 1
}
echo "âœ… All frontend tests passed."

echo ""
echo "ğŸš€ All checks passed. Proceeding with push."
